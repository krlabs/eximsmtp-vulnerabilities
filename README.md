# Список вразливостей Exim SMTP

Публікується з метою контролю безпеки сайтів на базі серверів з Exim SMTP. На замітку дослідникам та власникам електронних ресурсів. В рамках волонтерського проєкту "За вільний і безпечний UAnet!".

Дані вразливості були виявлені дослідниками KR. Laboratories в ході глобального аудиту ресурсів українського сегменту мережі Інтернет й можуть бути використані як легітимними пентестерами, так і зловмисниками для проведення різноманітних атак, зокрема: віддалене виконання коду (Remote Code Execution), несанкціонований доступ (Unauthorized Access), перехоплення даних "Людина посередині" (Man-in-the-Middle-Attack) та інших.

Ми рекомендуємо українським веб-майстрам і системним адміністраторам регулярно оновлювати серверне програмне забезпечення та використовувати наші рекомендації щодо кібербезпеки, аби мінімізувати потенційні ризики.  

З приводу захисту веб-серверів пишіть нам на електронну скриньку: security[@]kr-labs.com.ua

| **CVE Ідентифікатор** &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | **Опис** | **Exploit / PoC** |
|-----------------------------------------------------|----------|-------------|
| [**CVE-2018-6789**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6789)| Вразливість в функції base64d у прослухувачі SMTP. Під час надсилання створеного повідомлення може статися переповнення буфера. Це можна використовувати для віддаленого виконання коду (RCE). | [Експлойт1](https://www.exploit-db.com/exploits/44571) [Експлойт2](https://github.com/synacktiv/Exim-CVE-2018-6789) [PoC1](https://straightblast.medium.com/my-poc-walk-through-for-cve-2018-6789-2e402e4ff588) [PoC2](https://github.com/martinclauss/exim-rce-cve-2018-6789) |
| [**CVE-2019-10149**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-10149)| Критична вразливість дозволяє віддаленому зловмиснику виконувати довільні команди на сервері без автентифікації, використовуючи спеціально сформовані повідомлення SMTP. Вразливість отримала назву "The Return of the WIZard".  | [Експлойт1](https://github.com/Diefunction/CVE-2019-10149) [Експлойт2](https://github.com/darsigovrustam/CVE-2019-10149) [Експлойт3](https://www.exploit-db.com/exploits/46974) |
| [**CVE-2020-28018**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-28018)| Критична вразливість у поштовому сервері Exim, яка дозволяє віддаленому зловмиснику виконувати довільний код з правами root. Вразливість виникає через неправильну обробку введення в функціоналі обробки TLS-сертифікатів (OpenSSL). Зловмисник може скористатися спеціально сформованими даними під час встановлення TLS-з'єднання. | [PoC](https://github.com/dorkerdevil/CVE-2020-28018) |
| [**CVE-2023-42114**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42114)|  Дозволяє віддаленим зловмисникам без автентифікації отримувати доступ до конфіденційної інформації. Проблема виникає через неправильну обробку NTLM-запитів: недостатня перевірка даних, наданих користувачем, може призвести до читання за межами виділеної області пам'яті. Це дозволяє зловмиснику отримати доступ до інформації в контексті облікового запису служби.  | [Деталі](https://www.zerodayinitiative.com/advisories/ZDI-23-1468/) |
| [**CVE-2023-42115**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42115) |  Дозволяє неавтентифікованим віддаленим зловмисникам виконувати довільний код на уражених серверах з Exim, який працює через службу SMTP – за замовчуванням на порту 25, хоча також часто використовуються порти 26, 587 і 465. Проблема виникає через відсутність належної перевірки даних, наданих користувачем, що може призвести до запису після кінця буфера (AUTH Out-Of-Bounds Write). Успішне використання цієї вразливості може призвести до того, що зловмисник виконає шкідливий код у контексті облікового запису служби. Для використання цієї вразливості не потрібна автентифікація. | [Експлойт](https://github.com/kirinse/cve-2023-42115) |
| [**CVE-2023-42116**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42116)| Критична вразливість у поштовому сервері Exim, що дозволяє віддаленим зловмисникам виконувати довільний код без необхідності автентифікації. Проблема виникає через неправильну обробку NTLM-запитів: відсутність належної перевірки довжини даних, що надаються користувачем, призводить до переповнення буфера в стеку. Це може дозволити зловмиснику виконати код від імені облікового запису служби.  | [Деталі](https://www.cve.news/cve-2023-42116/) |
| [**CVE-2023-42117**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42117) | Дозволяє віддаленим зловмисникам виконувати довільний код без автентифікації. Проблема виникає через недостатню перевірку даних, наданих користувачем, що може призвести до пошкодження пам'яті. Зловмисник може скористатися цією вразливістю для виконання коду в контексті поточного процесу. | [Деталі](https://www.zerodayinitiative.com/advisories/ZDI-23-1471/) |
| [**CVE-2023-42118**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42118) | Вразливість у бібліотеці Exim libspf2, що дозволяє мережевим зловмисникам виконувати довільний код без автентифікації. Проблема виникає через неправильну обробку SPF макросів, що може призвести до переповнення цілого числа перед записом у пам'ять. Зловмисник може скористатися цією вразливістю для виконання коду в контексті облікового запису служби. | [Деталі](https://www.zerodayinitiative.com/advisories/ZDI-23-1472/) |
| [**CVE-2023-42119**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-42119) | Дозволяє віддаленим зловмисникам отримувати доступ до конфіденційної інформації. Проблема виникає через неправильну обробку DNS-запитів, що може призвести до читання за межами виділеної області пам'яті. Це дозволяє зловмиснику отримати доступ до інформації в контексті облікового запису служби. | [Деталі](https://www.zerodayinitiative.com/advisories/ZDI-23-1473/) |
| [**CVE-2024-39929**](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-39929) | Exim неправильно розбирає багаторядкову назву файлу заголовка RFC 2231, й таким чином віддалені зловмисники можуть обійти механізм захисту від блокування розширення $mime_filename та потенційно доставити виконувані вкладення до поштових скриньок кінцевих користувачів. | [Експлойт1](https://github.com/michael-david-fry/CVE-2024-39929) [Експлойт2](https://github.com/rxerium/CVE-2024-39929) |

## Джерела
- [Bugcrowd. EXIM Vulnerability Disclosure Program](https://bugcrowd.com/engagements/exim-vdp/)
- [Bugs Exim](https://bugs.exim.org)
- [Open CVE. Exim Vulnerabilities](https://app.opencve.io/cve/?&vendor=exim)
- [Exploit-DB. Exim](https://www.exploit-db.com/search?q=Exim)
- [DevCore Blog. Exim Off-by-one RCE: Exploiting CVE-2018-6789 with Fully Mitigations Bypassing](https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/)
- [Synacktiv. Scraps of Notes on Exploiting Exim Vulnerabilities](https://www.synacktiv.com/en/publications/scraps-of-notes-on-exploiting-exim-vulnerabilities.html)
